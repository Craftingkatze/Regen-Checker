<!DOCTYPE html>
<html lang="de">
<head> 
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=yes">
    <title>Wann ist es trocken?</title>
    <style>
        /* === VOLLE BILDSCHIRMNUTZUNG, APP-FEELING === */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        html, body {
            height: 100%;
            background-color: #4b5563;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            transition: background-color 0.4s ease;
        }

        body {
            display: flex;
            flex-direction: column;
            padding: 0;
        }

        /* Hintergrundfarben (werden per JS gesetzt) */
        body.green { background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
        body.yellow { background: linear-gradient(135deg, #eab308 0%, #ca8a04 100%); }
        body.red { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
        body.gray { background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%); }

        .container {
            flex: 1;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 12px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .card {
            background: rgba(255, 255, 255, 0.96);
            backdrop-filter: blur(2px);
            padding: 20px 16px;
            border-radius: 28px;
            margin-bottom: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        h1 {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: #1f2937;
            font-weight: 600;
            letter-spacing: -0.02em;
        }

        /* === SUCHE === */
        .search-wrapper {
            position: relative;
        }

        input {
            width: 100%;
            padding: 16px 18px;
            font-size: 16px;
            border-radius: 30px;
            border: 2px solid #e5e7eb;
            outline: none;
            background: #f9fafb;
            transition: all 0.2s;
            -webkit-appearance: none;
        }

        input:focus {
            border-color: #22c55e;
            background: white;
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.2);
        }

        .suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e5e7eb;
            border-top: none;
            border-radius: 0 0 24px 24px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 1000;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .suggestions div {
            padding: 14px 18px;
            cursor: pointer;
            border-bottom: 1px solid #f3f4f6;
        }

        .suggestions div:last-child { border-bottom: none; }
        .suggestions div:hover { background: #f0fdf4; }

        .suggestion-name { font-weight: 600; color: #1f2937; }
        .suggestion-detail { font-size: 13px; color: #6b7280; }

        /* === STATUS-ANZEIGE === */
        .status-text {
            font-size: 3.5rem;
            font-weight: 800;
            line-height: 1.1;
            margin-bottom: 8px;
            text-shadow: 2px 2px 10px rgba(0,0,0,0.1);
        }

        .location-info {
            font-size: 1.5rem;
            font-weight: 500;
            color: #1f2937;
        }

        .weather-info {
            font-size: 1.2rem;
            color: #4b5563;
            margin: 8px 0 16px 0;
        }

        /* Legende */
        .legend {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .legend-color {
            width: 28px;
            height: 20px;
            border-radius: 10px;
        }
        .legend-color.green { background: #22c55e; }
        .legend-color.yellow { background: #eab308; }
        .legend-color.red { background: #ef4444; }

        .legend-text { font-size: 14px; color: #374151; font-weight: 500; }

        /* === 7-TAGE TIMELINE (OHNE HORIZONTALSCROLL) === */
        .day {
            margin-bottom: 28px;
            background: rgba(255,255,255,0.4);
            border-radius: 28px;
            padding: 16px 12px;
            backdrop-filter: blur(4px);
        }

        .day-header {
            display: flex;
            align-items: baseline;
            gap: 12px;
            margin-bottom: 12px;
            flex-wrap: wrap;
            padding-left: 4px;
        }

        .weekday {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1f2937;
        }
        .date {
            font-size: 1rem;
            color: #4b5563;
            font-weight: 400;
        }

        .timeline-grid {
            display: grid;
            grid-template-rows: auto auto;
            gap: 4px;
            width: 100%;
        }

        .hour-row {
            display: grid;
            grid-template-columns: repeat(24, 1fr);
            text-align: center;
            font-size: 0.75rem;
            font-weight: 500;
            color: #1f2937;
            background: rgba(255,255,255,0.5);
            border-radius: 40px;
            padding: 6px 0;
        }

        .hour-row span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 0.7rem;
        }

        .block-row {
            display: grid;
            grid-template-columns: repeat(24, 1fr);
            gap: 3px;
        }

        .block {
            height: 40px;
            border-radius: 10px;
            transition: transform 0.1s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
            position: relative;
            cursor: pointer;
        }

        /* Blockfarben */
        .block.green { background: #22c55e; }
        .block.yellow { background: #eab308; }
        .block.red { background: #ef4444; }

        /* Kleiner weisser Strich oberhalb bei Regen (zus√§tzlicher Hinweis) */
        .block.red::after {
            content: '';
            position: absolute;
            top: -5px;
            left: 0;
            right: 0;
            height: 3px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 0 8px rgba(255,255,255,0.9);
        }

        .block:active { transform: scale(0.97); }

        /* Kein "Andere Stadt"-Button mehr ‚Äì wurde entfernt */

        /* Ladeanzeige */
        .loading {
            color: white;
            text-align: center;
            margin-top: 30vh;
            font-size: 2rem;
            font-weight: 600;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
            padding: 20px;
        }

        @media (max-width: 450px) {
            .hour-row span { font-size: 0.65rem; }
            .block { height: 36px; }
        }
    </style>
</head>
<body class="gray">

<div class="container" id="appContainer">
    <div class="card" id="startCard">
        <h1>üåßÔ∏è Regen ¬∑ Deutschland</h1>
        <div class="search-wrapper">
            <input id="locationInput" type="text" placeholder="Stadt oder Stadtteil..." autocomplete="on">
            <div class="suggestions" id="suggestions"></div>
        </div>
    </div>
</div>

<script>
(function() {
    const LOCATIONS = [
        {name:"Berlin", region:"Berlin", country:"Deutschland", lat:52.52, lon:13.405},
 {name:"Berlin-Mitte", region:"Berlin", country:"Deutschland", lat:52.5200, lon:13.4050},
 {name:"Berlin-Charlottenburg", region:"Berlin", country:"Deutschland", lat:52.5167, lon:13.2833},
 {name:"Berlin-Kreuzberg", region:"Berlin", country:"Deutschland", lat:52.4987, lon:13.4033},
 {name:"Berlin-Prenzlauer Berg", region:"Berlin", country:"Deutschland", lat:52.5333, lon:13.4167},
 {name:"Berlin-Neuk√∂lln", region:"Berlin", country:"Deutschland", lat:52.4769, lon:13.4372},
 
 {name:"Hamburg", region:"Hamburg", country:"Deutschland", lat:53.5511, lon:9.9937},
 {name:"Hamburg-Altona", region:"Hamburg", country:"Deutschland", lat:53.5525, lon:9.9358},
 {name:"Hamburg-Eimsb√ºttel", region:"Hamburg", country:"Deutschland", lat:53.5731, lon:9.9669},
 {name:"Hamburg-Harburg", region:"Hamburg", country:"Deutschland", lat:53.4569, lon:9.9814},
 {name:"Hamburg-Wandsbek", region:"Hamburg", country:"Deutschland", lat:53.5758, lon:10.0739},
 
 {name:"M√ºnchen", region:"Bayern", country:"Deutschland", lat:48.1351, lon:11.582},
 {name:"M√ºnchen-Schwabing", region:"Bayern", country:"Deutschland", lat:48.1667, lon:11.5833},
 {name:"M√ºnchen-Maxvorstadt", region:"Bayern", country:"Deutschland", lat:48.1500, lon:11.5667},
 {name:"M√ºnchen-Haidhausen", region:"Bayern", country:"Deutschland", lat:48.1333, lon:11.6000},
 {name:"M√ºnchen-Sendling", region:"Bayern", country:"Deutschland", lat:48.1167, lon:11.5500},
 
 {name:"K√∂ln", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9375, lon:6.9603},
 {name:"K√∂ln-Ehrenfeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9486, lon:6.9167},
 {name:"K√∂ln-Nippes", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9667, lon:6.9500},
 
 {name:"Frankfurt am Main", region:"Hessen", country:"Deutschland", lat:50.1109, lon:8.6821},
 {name:"Frankfurt-Sachsenhausen", region:"Hessen", country:"Deutschland", lat:50.0986, lon:8.6764},
 {name:"Frankfurt-Bornheim", region:"Hessen", country:"Deutschland", lat:50.1278, lon:8.7167},
 
 {name:"Stuttgart", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.7758, lon:9.1829},
 {name:"Stuttgart-Bad Cannstatt", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8056, lon:9.2167},
 
 {name:"D√ºsseldorf", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2277, lon:6.7735},
 {name:"D√ºsseldorf-Pempelfort", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2397, lon:6.7833},
 
 {name:"Leipzig", region:"Sachsen", country:"Deutschland", lat:51.3397, lon:12.3731},
 {name:"Dortmund", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5136, lon:7.4653},
 {name:"Essen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4556, lon:7.0116},
 {name:"Bremen", region:"Bremen", country:"Deutschland", lat:53.0793, lon:8.8017},
 {name:"Dresden", region:"Sachsen", country:"Deutschland", lat:51.0504, lon:13.7373},
 {name:"Hannover", region:"Niedersachsen", country:"Deutschland", lat:52.3759, lon:9.7320},
 {name:"N√ºrnberg", region:"Bayern", country:"Deutschland", lat:49.4521, lon:11.0767},
 {name:"Duisburg", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4344, lon:6.7623},
 {name:"Bochum", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4818, lon:7.2162},
 {name:"Wuppertal", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2562, lon:7.1508},
 {name:"Bielefeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:52.0302, lon:8.5325},
 {name:"Bonn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.7374, lon:7.0982},
 {name:"M√ºnster", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.9607, lon:7.6261},
 {name:"Karlsruhe", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.0069, lon:8.4037},
 {name:"Mannheim", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.4875, lon:8.4660},
 {name:"Augsburg", region:"Bayern", country:"Deutschland", lat:48.3705, lon:10.8978},
 {name:"Wiesbaden", region:"Hessen", country:"Deutschland", lat:50.0826, lon:8.2400},
 {name:"Gelsenkirchen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5177, lon:7.0857},
 {name:"M√∂nchengladbach", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1805, lon:6.4428},
 {name:"Braunschweig", region:"Niedersachsen", country:"Deutschland", lat:52.2689, lon:10.5268},
 {name:"Chemnitz", region:"Sachsen", country:"Deutschland", lat:50.8278, lon:12.9214},
 {name:"Kiel", region:"Schleswig-Holstein", country:"Deutschland", lat:54.3233, lon:10.1228},
 {name:"Aachen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.7753, lon:6.0839},
 {name:"Halle (Saale)", region:"Sachsen-Anhalt", country:"Deutschland", lat:51.4825, lon:11.9697},
 {name:"Magdeburg", region:"Sachsen-Anhalt", country:"Deutschland", lat:52.1205, lon:11.6276},
 {name:"Freiburg im Breisgau", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:47.9990, lon:7.8421},
 {name:"Krefeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3388, lon:6.5853},
 {name:"L√ºbeck", region:"Schleswig-Holstein", country:"Deutschland", lat:53.8655, lon:10.6866},
 {name:"Oberhausen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4963, lon:6.8516},
 {name:"Erfurt", region:"Th√ºringen", country:"Deutschland", lat:50.9848, lon:11.0299},
 {name:"Mainz", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.9929, lon:8.2473},
 {name:"Rostock", region:"Mecklenburg-Vorpommern", country:"Deutschland", lat:54.0924, lon:12.0991},
 {name:"Kassel", region:"Hessen", country:"Deutschland", lat:51.3127, lon:9.4797},
 {name:"Hagen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3671, lon:7.4633},
 {name:"Hamm", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.6773, lon:7.8150},
 {name:"Saarbr√ºcken", region:"Saarland", country:"Deutschland", lat:49.2401, lon:6.9969},
 {name:"M√ºlheim an der Ruhr", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4275, lon:6.8825},
 {name:"Potsdam", region:"Brandenburg", country:"Deutschland", lat:52.3906, lon:13.0645},
 {name:"Ludwigshafen am Rhein", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.4774, lon:8.4452},
 {name:"Oldenburg", region:"Niedersachsen", country:"Deutschland", lat:53.1435, lon:8.2146},
 {name:"Leverkusen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.0459, lon:6.9886},
 {name:"Osnabr√ºck", region:"Niedersachsen", country:"Deutschland", lat:52.2799, lon:8.0472},
 {name:"Solingen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1652, lon:7.0670},
 {name:"Heidelberg", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.3988, lon:8.6724},
 {name:"Herne", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5386, lon:7.2256},
 {name:"Neuss", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1979, lon:6.6854},
 {name:"Darmstadt", region:"Hessen", country:"Deutschland", lat:49.8728, lon:8.6512},
 {name:"Paderborn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.7189, lon:8.7575},
 {name:"Regensburg", region:"Bayern", country:"Deutschland", lat:49.0134, lon:12.1016},
 {name:"Ingolstadt", region:"Bayern", country:"Deutschland", lat:48.7665, lon:11.4257},
 {name:"W√ºrzburg", region:"Bayern", country:"Deutschland", lat:49.7913, lon:9.9534},
 {name:"F√ºrth", region:"Bayern", country:"Deutschland", lat:49.4778, lon:10.9897},
 {name:"Wolfsburg", region:"Niedersachsen", country:"Deutschland", lat:52.4227, lon:10.7865},
 {name:"Offenbach am Main", region:"Hessen", country:"Deutschland", lat:50.1006, lon:8.7663},
 {name:"Ulm", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.4011, lon:9.9876},
 {name:"Heilbronn", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.1427, lon:9.2109},
 {name:"Pforzheim", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8921, lon:8.6945},
 {name:"G√∂ttingen", region:"Niedersachsen", country:"Deutschland", lat:51.5412, lon:9.9158},
 {name:"Bottrop", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5244, lon:6.9289},
 {name:"Trier", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.7596, lon:6.6441},
 {name:"Recklinghausen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.6139, lon:7.1979},
 {name:"Reutlingen", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.4914, lon:9.2044},
 {name:"Bremerhaven", region:"Bremen", country:"Deutschland", lat:53.5395, lon:8.5809},
 {name:"Koblenz", region:"Rheinland-Pfalz", country:"Deutschland", lat:50.3569, lon:7.5890},
 {name:"Bergisch Gladbach", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9920, lon:7.1299},
 {name:"Jena", region:"Th√ºringen", country:"Deutschland", lat:50.9272, lon:11.5861},
 {name:"Remscheid", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1793, lon:7.1908},
 {name:"Erlangen", region:"Bayern", country:"Deutschland", lat:49.5897, lon:11.0087},
 {name:"Moers", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4508, lon:6.6264},
 {name:"Siegen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.8748, lon:8.0243},
 {name:"Hildesheim", region:"Niedersachsen", country:"Deutschland", lat:52.1513, lon:9.9517},
 {name:"Salzgitter", region:"Niedersachsen", country:"Deutschland", lat:52.1502, lon:10.3324},
 {name:"Cottbus", region:"Brandenburg", country:"Deutschland", lat:51.7606, lon:14.3340},
 {name:"G√ºtersloh", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.9067, lon:8.3858},
 {name:"Witten", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4387, lon:7.3333},
 {name:"Schwerin", region:"Mecklenburg-Vorpommern", country:"Deutschland", lat:53.6355, lon:11.4013},
 {name:"Gera", region:"Th√ºringen", country:"Deutschland", lat:50.8774, lon:12.0821},
 {name:"Iserlohn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3760, lon:7.6952},
 {name:"Zwickau", region:"Sachsen", country:"Deutschland", lat:50.7178, lon:12.4952},
 {name:"D√ºren", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.8025, lon:6.4833},
 {name:"Esslingen am Neckar", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.7397, lon:9.3094},
 {name:"Ratingen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2978, lon:6.8496},
 {name:"L√ºdenscheid", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2198, lon:7.6281},
 {name:"Ludwigsburg", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8974, lon:9.1916},
 {name:"Villingen-Schwenningen", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.0619, lon:8.4613}
];

    const WEEKDAYS = ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"];

    const input = document.getElementById("locationInput");
    const suggestions = document.getElementById("suggestions");
    const appContainer = document.getElementById("appContainer");

    // Suchfunktion
    input.addEventListener("input", () => {
        const q = input.value.toLowerCase().trim();
        suggestions.innerHTML = "";
        if (q.length < 2) {
            suggestions.style.display = "none";
            return;
        }
        const results = LOCATIONS
            .filter(l => l.name.toLowerCase().includes(q) || l.region.toLowerCase().includes(q))
            .slice(0, 8);
        if (results.length === 0) {
            suggestions.style.display = "none";
            return;
        }
        results.forEach(loc => {
            const div = document.createElement("div");
            div.innerHTML = `<div class="suggestion-name">${loc.name}</div>
                             <div class="suggestion-detail">${loc.region}, ${loc.country}</div>`;
            div.onclick = () => selectLocation(loc);
            suggestions.appendChild(div);
        });
        suggestions.style.display = "block";
    });

    document.addEventListener("click", (e) => {
        if (!e.target.closest(".search-wrapper")) {
            suggestions.style.display = "none";
        }
    });

    function selectLocation(location) {
        suggestions.style.display = "none";
        loadWeather(location);
    }

    // Statusfarbe + Text
    function getStatus(data, index) {
        const precipNow = data.hourly.precipitation[index] || 0;
        const rainNext3h = data.hourly.precipitation.slice(index, index + 3).some(p => p >= 0.5);
        const rainPrev3h = data.hourly.precipitation.slice(Math.max(0, index - 3), index).some(p => p >= 0.5);
        const humidityNow = data.hourly.relative_humidity_2m[index] || 0;
    
        if (precipNow >= 0.5 || rainNext3h) return { color: "red", text: "ACHTUNG" };
        if (rainPrev3h || humidityNow > 80) return { color: "yellow", text: "FEUCHT" };
        return { color: "green", text: "TROCKEN" };
    }

    async function loadWeather(location) {
        document.body.className = "gray";
        document.body.innerHTML = `<div class="loading">üå§Ô∏è Lade Wetter f√ºr ${location.name} ‚Ä¶</div>`;

        try {
            const url = `https://api.open-meteo.com/v1/forecast?latitude=${location.lat}&longitude=${location.lon}&hourly=temperature_2m,relative_humidity_2m,precipitation&timezone=auto&forecast_days=7`;
            const res = await fetch(url);
            const data = await res.json();

            // Aktuelle Stunde bestimmen
            const now = new Date();
            const index = data.hourly.time.findIndex(t => new Date(t) >= now);
            const precip = data.hourly.precipitation[index] || 0;
            const humidity = data.hourly.relative_humidity_2m[index] || 0;
            const temp = Math.round(data.hourly.temperature_2m[index] || 0);
            const rainSoon = data.hourly.precipitation.slice(index, index + 3).some(p => p > 0);
            const status = getStatus(data, index);
            document.body.className = status.color;

            // Container neu aufbauen (OHNE "Andere Stadt" Button)
            const container = document.createElement("div");
            container.className = "container";
            container.innerHTML = `
                <div class="card">
                    <div class="status-text">${status.text}</div>
                    <div class="location-info">${location.name}</div>
                    <div class="weather-info">${temp}¬∞C ¬∑ Luftfeuchtigkeit ${humidity}%</div>
                    <div class="legend">
                        <div class="legend-item"><div class="legend-color green"></div><span class="legend-text">Trocken</span></div>
                        <div class="legend-item"><div class="legend-color yellow"></div><span class="legend-text">Feucht >85%</span></div>
                        <div class="legend-item"><div class="legend-color red"></div><span class="legend-text">Regen</span></div>
                    </div>
                </div>
                <div class="card">
                    <h2 style="margin-bottom:16px;">‚è≥ 7-Tage Vorhersage</h2>
                    <div id="timeline"></div>
                </div>
            `;

            document.body.innerHTML = "";
            document.body.appendChild(container);

            // Daten f√ºr jeden Tag aufbereiten: Array mit Stunden-Objekten
            const days = {}; // { "2025-02-14": { hours: [{ time, temp, humidity, precip, color }] } }

            data.hourly.time.forEach((t, i) => {
                const d = t.split("T")[0];
                if (!days[d]) days[d] = { hours: [] };
            
                const timeStr = t.split("T")[1].substring(0,5);
                const tempVal = data.hourly.temperature_2m[i];
                const humVal = data.hourly.relative_humidity_2m[i];
                const precipVal = data.hourly.precipitation[i] || 0;
            
                // Index-basiert Status ermitteln
                const statusObj = getStatus(data, i);
                const color = statusObj.color;
            
                days[d].hours.push({
                    time: timeStr,
                    temp: tempVal,
                    humidity: humVal,
                    precip: precipVal,
                    color: color
                });
            });

            const timeline = document.getElementById("timeline");
            timeline.innerHTML = "";

            // Schrittweite f√ºr die Stundenanzeige (abh√§ngig von Bildschirmbreite)
            const step = window.innerWidth < 500 ? 2 : 1; // bei schmalen Ger√§ten nur jede 2. Stunde als Zahl

                    // Tage durchgehen und Grid aufbauen
            Object.keys(days).forEach(date => {
                const dateObj = new Date(date + "T12:00:00");
                const weekday = WEEKDAYS[dateObj.getDay()];
                const dayHours = days[date].hours; // Array mit 24 Eintr√§gen

                const dayDiv = document.createElement("div");
                dayDiv.className = "day";

                // Kopf
                const header = document.createElement("div");
                header.className = "day-header";
                header.innerHTML = `<span class="weekday">${weekday}</span><span class="date">${date}</span>`;
                dayDiv.appendChild(header);

                // Grid
                const grid = document.createElement("div");
                grid.className = "timeline-grid";

                // Stundenzeile (mit verd√ºnnten Zahlen + Regen-Icons)
                              // Stundenzeile (Zahl unten, Regen-Symbol oben)
                const hourRow = document.createElement("div");
                hourRow.className = "hour-row";
                hourRow.style.display = "grid";
                hourRow.style.gridTemplateColumns = "repeat(24, 1fr)";
                hourRow.style.gap = "4px";
                
                for (let h = 0; h < 24; h++) {
                    const hourData = dayHours[h];
                
                    const span = document.createElement("span");
                    span.style.display = "flex";
                    span.style.flexDirection = "column"; // vertikal
                    span.style.alignItems = "center";
                    span.style.justifyContent = "flex-start";
                    span.style.transform = "rotate(-90deg)";
                    span.style.transformOrigin = "center center";
                    span.style.whiteSpace = "nowrap";
                    span.title = hourData.time + " Uhr";
                
                    // Regen-Symbol oben
                    const rain = document.createElement("span");
                    rain.textContent = hourData.precip > 0 ? "üåßÔ∏è" : "";
                    rain.style.fontSize = "0.8em";
                    span.appendChild(rain);
                
                    // Zahl unten
                    const num = document.createElement("span");
                    num.textContent = h < 10 ? h.toString() : h.toString();
                    num.style.fontWeight = "600";
                    span.appendChild(num);
                
                    hourRow.appendChild(span);
                }

                // Blockreihe (anklickbar)
                const blockRow = document.createElement("div");
                blockRow.className = "block-row";

                dayHours.forEach((hourData, idx) => {
                    const block = document.createElement("div");
                    block.className = `block ${hourData.color}`;
                    block.setAttribute("data-time", hourData.time);
                    block.setAttribute("data-temp", hourData.temp);
                    block.setAttribute("data-humidity", hourData.humidity);
                    block.setAttribute("data-precip", hourData.precip);

                    // Klick-Event f√ºr genauere Infos
                    block.addEventListener("click", (e) => {
                        const time = e.currentTarget.dataset.time;
                        const temp = e.currentTarget.dataset.temp;
                        const hum = e.currentTarget.dataset.humidity;
                        const precip = e.currentTarget.dataset.precip;
                        alert(`üìç ${time} Uhr\nüå°Ô∏è Temperatur: ${temp}¬∞C\nüíß Luftfeuchtigkeit: ${hum}%\n‚òî Niederschlag: ${precip} mm`);
                    });

                    blockRow.appendChild(block);
                });

                grid.appendChild(hourRow);
                grid.appendChild(blockRow);
                dayDiv.appendChild(grid);
                timeline.appendChild(dayDiv);
            });

        } catch (e) {
            document.body.innerHTML = `<div class="loading">‚ùå Fehler beim Laden.<br><button onclick="location.reload()" style="margin-top:20px; padding:12px 24px; background:white; color:black; border:none; border-radius:40px;">‚Üª Neu laden</button></div>`;
            console.error(e);
        }
    }

    // Enter-Taste: ersten Vorschlag nehmen
    input.addEventListener("keypress", (e) => {
        if (e.key === "Enter" && suggestions.children.length > 0) {
            suggestions.children[0].click();
        }
    });

})();
</script>
</body>
</html>
