<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Regen Status - Deutschland</title>

<style>
* { margin:0; padding:0; box-sizing:border-box; }

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
    transition: background-color .4s ease;
    padding:20px;
    min-height:100vh;
}

body.green { background:linear-gradient(135deg, #22c55e 0%, #16a34a 100%); }
body.yellow { background:linear-gradient(135deg, #eab308 0%, #ca8a04 100%); }
body.red { background:linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }
body.gray { background:linear-gradient(135deg, #6b7280 0%, #4b5563 100%); }

.container { max-width:1200px; margin:auto; }

.card {
    background:rgba(255,255,255,.96);
    padding:35px;
    border-radius:18px;
    margin-bottom:25px;
    box-shadow:0 10px 40px rgba(0,0,0,.15);
}

h1 { 
    margin-bottom:20px; 
    font-size:32px;
    color:#1f2937;
}

.search-wrapper {
    position:relative;
}

input {
    width:100%;
    padding:18px 20px;
    font-size:18px;
    border-radius:12px;
    border:2px solid #e5e7eb;
    outline:none;
    transition:all .3s;
    background:#f9fafb;
}

input:focus { 
    border-color:#22c55e; 
    background:white;
    box-shadow:0 4px 12px rgba(34,197,94,.1);
}

.suggestions {
    position:absolute;
    top:100%;
    left:0;
    right:0;
    background:white;
    border:2px solid #e5e7eb;
    border-top:none;
    border-radius:0 0 12px 12px;
    max-height:400px;
    overflow-y:auto;
    display:none;
    box-shadow:0 10px 25px rgba(0,0,0,.1);
    z-index:1000;
}

.suggestions div {
    padding:14px 20px;
    cursor:pointer;
    transition:background .2s;
    border-bottom:1px solid #f3f4f6;
}

.suggestions div:last-child {
    border-bottom:none;
}

.suggestions div:hover {
    background:#f0fdf4;
}

.suggestion-name {
    font-weight:600;
    color:#1f2937;
    margin-bottom:2px;
}

.suggestion-detail {
    font-size:13px;
    color:#6b7280;
}

.status-text {
    font-size:64px;
    font-weight:bold;
    margin-bottom:15px;
    text-shadow:2px 2px 8px rgba(0,0,0,.1);
}

.location-info {
    font-size:24px;
    color:#4b5563;
    margin-bottom:8px;
}

.weather-info {
    font-size:20px;
    color:#6b7280;
    margin-bottom:20px;
}

.timeline-wrapper {
    overflow-x:auto;
}

.day {
    margin-bottom:25px;
    padding-bottom:20px;
    border-bottom:1px solid #e5e7eb;
}

.day:last-child {
    border-bottom:none;
}

.day-header {
    display:flex;
    align-items:center;
    gap:12px;
    margin-bottom:15px;
}

.weekday {
    font-size:22px;
    font-weight:700;
    color:#1f2937;
    min-width:50px;
}

.date {
    font-size:16px;
    color:#6b7280;
}

.timeline-container {
    position:relative;
}

.timeline {
    display:flex;
    gap:3px;
    height:40px;
    margin-top:35px;
}

.time-labels {
    display:flex;
    gap:3px;
    margin-bottom:8px;
    position:absolute;
    top:-30px;
    left:0;
    right:0;
}

.time-label {
    flex:1;
    text-align:center;
    font-size:11px;
    color:#6b7280;
    writing-mode:vertical-rl;
    transform:rotate(180deg);
    font-weight:500;
}

.block {
    flex:1;
    border-radius:4px;
    transition:transform .2s;
}

.block:hover {
    transform:scaleY(1.15);
    cursor:pointer;
}

.block.green { background:#22c55e; }
.block.yellow { background:#eab308; }
.block.red { background:#ef4444; }

button {
    margin-top:15px;
    padding:12px 24px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    font-size:16px;
    font-weight:600;
    background:#1f2937;
    color:white;
    transition:all .3s;
    box-shadow:0 4px 12px rgba(0,0,0,.1);
}

button:hover {
    background:#374151;
    transform:translateY(-2px);
    box-shadow:0 6px 16px rgba(0,0,0,.15);
}

.loading {
    color:white;
    text-align:center;
    margin-top:100px;
    font-size:28px;
    font-weight:600;
}

.legend {
    display:flex;
    gap:20px;
    margin-top:20px;
    padding-top:20px;
    border-top:1px solid #e5e7eb;
}

.legend-item {
    display:flex;
    align-items:center;
    gap:8px;
}

.legend-color {
    width:30px;
    height:20px;
    border-radius:4px;
}

.legend-text {
    font-size:14px;
    color:#6b7280;
}
</style>
</head>

<body class="gray">

<div class="container">

<div class="card" id="startCard">
<h1>üåßÔ∏è Regen Vorhersage Deutschland</h1>
<div class="search-wrapper">
<input id="locationInput" placeholder="Stadt oder Stadtteil eingeben...">
<div class="suggestions" id="suggestions"></div>
</div>
</div>

</div>

<script>

const LOCATIONS = [
 // Top 100 St√§dte Deutschland + wichtige Stadtteile
 {name:"Berlin", region:"Berlin", country:"Deutschland", lat:52.52, lon:13.405},
 {name:"Berlin-Mitte", region:"Berlin", country:"Deutschland", lat:52.5200, lon:13.4050},
 {name:"Berlin-Charlottenburg", region:"Berlin", country:"Deutschland", lat:52.5167, lon:13.2833},
 {name:"Berlin-Kreuzberg", region:"Berlin", country:"Deutschland", lat:52.4987, lon:13.4033},
 {name:"Berlin-Prenzlauer Berg", region:"Berlin", country:"Deutschland", lat:52.5333, lon:13.4167},
 {name:"Berlin-Neuk√∂lln", region:"Berlin", country:"Deutschland", lat:52.4769, lon:13.4372},
 
 {name:"Hamburg", region:"Hamburg", country:"Deutschland", lat:53.5511, lon:9.9937},
 {name:"Hamburg-Altona", region:"Hamburg", country:"Deutschland", lat:53.5525, lon:9.9358},
 {name:"Hamburg-Eimsb√ºttel", region:"Hamburg", country:"Deutschland", lat:53.5731, lon:9.9669},
 {name:"Hamburg-Harburg", region:"Hamburg", country:"Deutschland", lat:53.4569, lon:9.9814},
 {name:"Hamburg-Wandsbek", region:"Hamburg", country:"Deutschland", lat:53.5758, lon:10.0739},
 
 {name:"M√ºnchen", region:"Bayern", country:"Deutschland", lat:48.1351, lon:11.582},
 {name:"M√ºnchen-Schwabing", region:"Bayern", country:"Deutschland", lat:48.1667, lon:11.5833},
 {name:"M√ºnchen-Maxvorstadt", region:"Bayern", country:"Deutschland", lat:48.1500, lon:11.5667},
 {name:"M√ºnchen-Haidhausen", region:"Bayern", country:"Deutschland", lat:48.1333, lon:11.6000},
 {name:"M√ºnchen-Sendling", region:"Bayern", country:"Deutschland", lat:48.1167, lon:11.5500},
 
 {name:"K√∂ln", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9375, lon:6.9603},
 {name:"K√∂ln-Ehrenfeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9486, lon:6.9167},
 {name:"K√∂ln-Nippes", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9667, lon:6.9500},
 
 {name:"Frankfurt am Main", region:"Hessen", country:"Deutschland", lat:50.1109, lon:8.6821},
 {name:"Frankfurt-Sachsenhausen", region:"Hessen", country:"Deutschland", lat:50.0986, lon:8.6764},
 {name:"Frankfurt-Bornheim", region:"Hessen", country:"Deutschland", lat:50.1278, lon:8.7167},
 
 {name:"Stuttgart", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.7758, lon:9.1829},
 {name:"Stuttgart-Bad Cannstatt", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8056, lon:9.2167},
 
 {name:"D√ºsseldorf", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2277, lon:6.7735},
 {name:"D√ºsseldorf-Pempelfort", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2397, lon:6.7833},
 
 {name:"Leipzig", region:"Sachsen", country:"Deutschland", lat:51.3397, lon:12.3731},
 {name:"Dortmund", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5136, lon:7.4653},
 {name:"Essen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4556, lon:7.0116},
 {name:"Bremen", region:"Bremen", country:"Deutschland", lat:53.0793, lon:8.8017},
 {name:"Dresden", region:"Sachsen", country:"Deutschland", lat:51.0504, lon:13.7373},
 {name:"Hannover", region:"Niedersachsen", country:"Deutschland", lat:52.3759, lon:9.7320},
 {name:"N√ºrnberg", region:"Bayern", country:"Deutschland", lat:49.4521, lon:11.0767},
 {name:"Duisburg", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4344, lon:6.7623},
 {name:"Bochum", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4818, lon:7.2162},
 {name:"Wuppertal", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2562, lon:7.1508},
 {name:"Bielefeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:52.0302, lon:8.5325},
 {name:"Bonn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.7374, lon:7.0982},
 {name:"M√ºnster", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.9607, lon:7.6261},
 {name:"Karlsruhe", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.0069, lon:8.4037},
 {name:"Mannheim", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.4875, lon:8.4660},
 {name:"Augsburg", region:"Bayern", country:"Deutschland", lat:48.3705, lon:10.8978},
 {name:"Wiesbaden", region:"Hessen", country:"Deutschland", lat:50.0826, lon:8.2400},
 {name:"Gelsenkirchen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5177, lon:7.0857},
 {name:"M√∂nchengladbach", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1805, lon:6.4428},
 {name:"Braunschweig", region:"Niedersachsen", country:"Deutschland", lat:52.2689, lon:10.5268},
 {name:"Chemnitz", region:"Sachsen", country:"Deutschland", lat:50.8278, lon:12.9214},
 {name:"Kiel", region:"Schleswig-Holstein", country:"Deutschland", lat:54.3233, lon:10.1228},
 {name:"Aachen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.7753, lon:6.0839},
 {name:"Halle (Saale)", region:"Sachsen-Anhalt", country:"Deutschland", lat:51.4825, lon:11.9697},
 {name:"Magdeburg", region:"Sachsen-Anhalt", country:"Deutschland", lat:52.1205, lon:11.6276},
 {name:"Freiburg im Breisgau", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:47.9990, lon:7.8421},
 {name:"Krefeld", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3388, lon:6.5853},
 {name:"L√ºbeck", region:"Schleswig-Holstein", country:"Deutschland", lat:53.8655, lon:10.6866},
 {name:"Oberhausen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4963, lon:6.8516},
 {name:"Erfurt", region:"Th√ºringen", country:"Deutschland", lat:50.9848, lon:11.0299},
 {name:"Mainz", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.9929, lon:8.2473},
 {name:"Rostock", region:"Mecklenburg-Vorpommern", country:"Deutschland", lat:54.0924, lon:12.0991},
 {name:"Kassel", region:"Hessen", country:"Deutschland", lat:51.3127, lon:9.4797},
 {name:"Hagen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3671, lon:7.4633},
 {name:"Hamm", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.6773, lon:7.8150},
 {name:"Saarbr√ºcken", region:"Saarland", country:"Deutschland", lat:49.2401, lon:6.9969},
 {name:"M√ºlheim an der Ruhr", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4275, lon:6.8825},
 {name:"Potsdam", region:"Brandenburg", country:"Deutschland", lat:52.3906, lon:13.0645},
 {name:"Ludwigshafen am Rhein", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.4774, lon:8.4452},
 {name:"Oldenburg", region:"Niedersachsen", country:"Deutschland", lat:53.1435, lon:8.2146},
 {name:"Leverkusen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.0459, lon:6.9886},
 {name:"Osnabr√ºck", region:"Niedersachsen", country:"Deutschland", lat:52.2799, lon:8.0472},
 {name:"Solingen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1652, lon:7.0670},
 {name:"Heidelberg", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.3988, lon:8.6724},
 {name:"Herne", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5386, lon:7.2256},
 {name:"Neuss", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1979, lon:6.6854},
 {name:"Darmstadt", region:"Hessen", country:"Deutschland", lat:49.8728, lon:8.6512},
 {name:"Paderborn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.7189, lon:8.7575},
 {name:"Regensburg", region:"Bayern", country:"Deutschland", lat:49.0134, lon:12.1016},
 {name:"Ingolstadt", region:"Bayern", country:"Deutschland", lat:48.7665, lon:11.4257},
 {name:"W√ºrzburg", region:"Bayern", country:"Deutschland", lat:49.7913, lon:9.9534},
 {name:"F√ºrth", region:"Bayern", country:"Deutschland", lat:49.4778, lon:10.9897},
 {name:"Wolfsburg", region:"Niedersachsen", country:"Deutschland", lat:52.4227, lon:10.7865},
 {name:"Offenbach am Main", region:"Hessen", country:"Deutschland", lat:50.1006, lon:8.7663},
 {name:"Ulm", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.4011, lon:9.9876},
 {name:"Heilbronn", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:49.1427, lon:9.2109},
 {name:"Pforzheim", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8921, lon:8.6945},
 {name:"G√∂ttingen", region:"Niedersachsen", country:"Deutschland", lat:51.5412, lon:9.9158},
 {name:"Bottrop", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.5244, lon:6.9289},
 {name:"Trier", region:"Rheinland-Pfalz", country:"Deutschland", lat:49.7596, lon:6.6441},
 {name:"Recklinghausen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.6139, lon:7.1979},
 {name:"Reutlingen", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.4914, lon:9.2044},
 {name:"Bremerhaven", region:"Bremen", country:"Deutschland", lat:53.5395, lon:8.5809},
 {name:"Koblenz", region:"Rheinland-Pfalz", country:"Deutschland", lat:50.3569, lon:7.5890},
 {name:"Bergisch Gladbach", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.9920, lon:7.1299},
 {name:"Jena", region:"Th√ºringen", country:"Deutschland", lat:50.9272, lon:11.5861},
 {name:"Remscheid", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.1793, lon:7.1908},
 {name:"Erlangen", region:"Bayern", country:"Deutschland", lat:49.5897, lon:11.0087},
 {name:"Moers", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4508, lon:6.6264},
 {name:"Siegen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.8748, lon:8.0243},
 {name:"Hildesheim", region:"Niedersachsen", country:"Deutschland", lat:52.1513, lon:9.9517},
 {name:"Salzgitter", region:"Niedersachsen", country:"Deutschland", lat:52.1502, lon:10.3324},
 {name:"Cottbus", region:"Brandenburg", country:"Deutschland", lat:51.7606, lon:14.3340},
 {name:"G√ºtersloh", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.9067, lon:8.3858},
 {name:"Witten", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.4387, lon:7.3333},
 {name:"Schwerin", region:"Mecklenburg-Vorpommern", country:"Deutschland", lat:53.6355, lon:11.4013},
 {name:"Gera", region:"Th√ºringen", country:"Deutschland", lat:50.8774, lon:12.0821},
 {name:"Iserlohn", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.3760, lon:7.6952},
 {name:"Zwickau", region:"Sachsen", country:"Deutschland", lat:50.7178, lon:12.4952},
 {name:"D√ºren", region:"Nordrhein-Westfalen", country:"Deutschland", lat:50.8025, lon:6.4833},
 {name:"Esslingen am Neckar", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.7397, lon:9.3094},
 {name:"Ratingen", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2978, lon:6.8496},
 {name:"L√ºdenscheid", region:"Nordrhein-Westfalen", country:"Deutschland", lat:51.2198, lon:7.6281},
 {name:"Ludwigsburg", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.8974, lon:9.1916},
 {name:"Villingen-Schwenningen", region:"Baden-W√ºrttemberg", country:"Deutschland", lat:48.0619, lon:8.4613}
];

const WEEKDAYS = ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"];

const input = document.getElementById("locationInput");
const suggestions = document.getElementById("suggestions");

input.addEventListener("input", () => {
    const q = input.value.toLowerCase();
    suggestions.innerHTML = "";
    if(q.length < 2) return suggestions.style.display="none";

    const results = LOCATIONS.filter(l => 
        l.name.toLowerCase().includes(q) || 
        l.region.toLowerCase().includes(q)
    ).slice(0, 10);

    if(results.length === 0) return suggestions.style.display="none";

    results.forEach(loc => {
        const div = document.createElement("div");
        div.innerHTML = `
            <div class="suggestion-name">${loc.name}</div>
            <div class="suggestion-detail">${loc.region}, ${loc.country}</div>
        `;
        div.onclick = () => selectLocation(loc);
        suggestions.appendChild(div);
    });

    suggestions.style.display="block";
});

document.addEventListener("click", (e) => {
    if(!e.target.closest(".search-wrapper")) {
        suggestions.style.display="none";
    }
});

function selectLocation(location){
    suggestions.style.display="none";
    loadWeather(location);
}

function getStatus(precip, humidity, rainSoon){
    if(precip > 0 || rainSoon) return {color:"red", text:"ACHTUNG"};
    if(humidity > 85) return {color:"yellow", text:"FEUCHT"};
    return {color:"green", text:"TROCKEN"};
}

async function loadWeather(location){

    document.body.className="gray";
    document.body.innerHTML="<div class='loading'>Lade Wetter f√ºr " + location.name + "...</div>";

    try{
        const url=`https://api.open-meteo.com/v1/forecast?latitude=${location.lat}&longitude=${location.lon}&hourly=temperature_2m,relative_humidity_2m,precipitation&timezone=auto&forecast_days=7`;

        const res=await fetch(url);
        const data=await res.json();

        const now=new Date();
        const index=data.hourly.time.findIndex(t=>new Date(t)>=now);

        const precip=data.hourly.precipitation[index]||0;
        const humidity=data.hourly.relative_humidity_2m[index]||0;
        const temp=Math.round(data.hourly.temperature_2m[index]||0);

        const rainSoon=data.hourly.precipitation.slice(index,index+4).some(p=>p>0);

        const status=getStatus(precip,humidity,rainSoon);

        document.body.className=status.color;

        const container=document.createElement("div");
        container.className="container";

        container.innerHTML=`
        <div class="card">
            <div class="status-text">${status.text}</div>
            <div class="location-info">${location.name}</div>
            <div class="weather-info">${temp}¬∞C | Luftfeuchtigkeit: ${humidity}%</div>
            <button onclick="location.reload()">üîç Andere Stadt</button>
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-color green"></div>
                    <span class="legend-text">Trocken</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color yellow"></div>
                    <span class="legend-text">Feucht (>85%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color red"></div>
                    <span class="legend-text">Regen</span>
                </div>
            </div>
        </div>
        <div class="card">
            <h2 style="margin-bottom:20px;">7-Tage Vorhersage</h2>
            <div id="timeline"></div>
        </div>
        `;

        document.body.innerHTML="";
        document.body.appendChild(container);

        const days={};

        data.hourly.time.forEach((t,i)=>{
            const d=t.split("T")[0];
            if(!days[d]) days[d]={colors:[], times:[]};
            const p=data.hourly.precipitation[i]||0;
            const h=data.hourly.relative_humidity_2m[i]||0;
            const soon=data.hourly.precipitation.slice(i,i+3).some(x=>x>0);
            days[d].colors.push(getStatus(p,h,soon).color);
            days[d].times.push(t.split("T")[1].substring(0,5));
        });

        const timeline=document.getElementById("timeline");

        Object.keys(days).forEach(date=>{
            const dateObj = new Date(date + "T12:00:00");
            const weekday = WEEKDAYS[dateObj.getDay()];
            
            const div=document.createElement("div");
            div.className="day";
            div.innerHTML=`
                <div class="day-header">
                    <span class="weekday">${weekday}</span>
                    <span class="date">${date}</span>
                </div>
                <div class="timeline-container">
                    <div class="time-labels"></div>
                    <div class="timeline"></div>
                </div>
            `;
            
            const timeLabels = div.querySelector(".time-labels");
            const row=div.querySelector(".timeline");
            
            days[date].colors.forEach((color, idx)=>{
                const time = days[date].times[idx];
                
                // Zeit-Label (nur jede 3. Stunde anzeigen)
                if(idx % 3 === 0 || idx === 0) {
                    const timeLabel = document.createElement("div");
                    timeLabel.className = "time-label";
                    timeLabel.textContent = time;
                    timeLabels.appendChild(timeLabel);
                } else {
                    const spacer = document.createElement("div");
                    spacer.className = "time-label";
                    spacer.style.opacity = "0";
                    timeLabels.appendChild(spacer);
                }
                
                // Farbblock
                const b=document.createElement("div");
                b.className="block "+color;
                b.title=`${time} Uhr`;
                row.appendChild(b);
            });
            
            timeline.appendChild(div);
        });

    }catch(e){
        document.body.innerHTML="<div class='loading'>‚ùå Fehler beim Laden der Wetterdaten</div>";
        console.error(e);
    }
}

</script>
</body>
</html>
